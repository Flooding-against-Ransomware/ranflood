# Ranflood

<img src="icon.png?raw=true" width="33%">

Ranflood consists of two programs: a client (`ranflood`) and a daemon (`ranfloodd`).

The user interacts with the client to issue commands to the daemon.

At the moment, Ranflood supports three types of flooding strategies:

- `random`: based on the flooding of a given location with randomly-generated files.
- `on-the-fly`:  a is copy-based strategy, where the generation of files uses copies of actual files found at a flooding location. File replication adds a layer of defence as it helps to increase the likelihood of preserving the usersâ€™ files by generating additional, valid copies that might escape the ransomware.
This strategy introduces a new `snapshoot` action that precedes the flooding one, which saves a list of the valid files with their digest signature (e.g., MD5), so that the flooding operations can use the signature as an integrity verification to skip the encrypted files. 
- `shadow`: another copy-based strategy which increases the efficiency of the `on-the-fly` by preserving archival copies of the files of the user.

The daemon should run as a service (always on, restarted if it crashes, etc.). The daemon accepts as a parameter a path to a `setting.ini` file which reports where to store the on-the-fly and shadow-copy DBs and archives and sets its request address (the default is `localhost:7890`).

For instance, an example `setting.ini` file for a Windows installation is

```[RandomFlooder]
MaxFileSize = 768 KB
[OnTheFlyFlooder]
Signature_DB = C:\Users\thesave\Desktop\ranflood_testsite\signatures.db
ExcludeFolderNames = Application Data, OtherFolder
[ShadowCopyFlooder]
ArchiveDatabase = C:\Users\thesave\Desktop\ranflood_testsite\archives.db
ArchiveRoot = C:\Users\thesave\Desktop\ranflood_testsite\archives
ExcludeFolderNames = Application Data, OtherFolder
[ZMQ_JSON_Server]
address = tcp://localhost:7890
```

The playground folder in this repo includes an [illustrative setting.ini](https://github.com/thesave/ranflood/blob/master/src/tests/java/playground/settings.ini) file for Linux/macOS.

## Using the Ranflood Client

Issuing the command `ranflood --help` shows the list of actions users can invoke on the running daemon, through the client.

Roughly, the main commands users can issue to the Ranflood daemon have the following three parameters:

- `action`: whether we want to `flood` or perform a data `snapshot` (the latter is for issuing copy-based strategies);
- `target folder`: the folder where to perform the action;
- `method``: the strategy we consider for the action (Random, On-the-Fly, Shadow).

Focussing on the \texttt{flood} command, we have three sub-actions we can ask
the daemon to perform:

\begin{itemize}
    \item \texttt{ranflood flood list}: list all ongoing flooding operations, identified by a unique id (here, the target folder and method parameters are immaterial);
    \item \texttt{ranflood flood start <method> <targetFolder>}: start a flooding operation (Random, On-the-fly, Shadow) on a specific folder;
    \item \texttt{ranflood flood stop <method> <ids>}: stop a list of flooding operations, identified via their ids (since the id identifies an ongoing operation on a target folder, the latter is irrelevant).
\end{itemize}

After a ransomware attack, mitigated using copy-based Ranflood strategies, we
can run a restoration phase where we try to recover the original environment
of the user before the attack, both trying to restore the files of the user lost
to encryption and remove the decoy files generated by Ranflood.

Since this phase is distinct from the mitigation one, we implement the needed
routines within a separate tool which we only overview, to keep our focus on
Ranflood---future versions of Ranflood could include the additional
functionalities of the restoration tool to cover a wider range of the ransomware
contrast spectrum. Briefly, the restoration tool compares the files found in the
attacked locations with the signatures of the files of the user (obtained before
an attack, similar to the snapshooting operations of the On-the-Fly strategy),
either finding the original copy of the user or replacing the latter with a
flooding-generated replica, if any.

## To Do

- [ ] Export the following components in separate repositories
  - [ ] [FileChecker](/master/src/filechecker/java/org/ranflood/filechecker) and [analyser](/master/result_analyser)
  - [ ] Rig [management](/master/management-scripts) and [testing](/master/scripts) scripts
  - [ ] [Ransomware Samples](resources/ransomwares)


## Cite this repository

If you use this software in your work, please cite it using the following metadata.

```
@article{BGMMOP23,
  title = {Data Flooding against Ransomware: Concepts and Implementations},
  author = {Davide Berardi and Saverio Giallorenzo and Andrea Melis and Simone Melloni and Loris Onori and Marco Prandini},
  journal = {Computers & Security},
  pages = {103295},
  year = {2023},
  issn = {0167-4048},
  doi = {https://doi.org/10.1016/j.cose.2023.103295},
}
```
